<template>
  <div v-title="labels.title">
    <div class="ui vertical stripe segment">
      <div class="ui stackable three column grid">
        <div class="column">
          <track-widget :url="'history/listenings/'" :filters="{scope: 'user', ordering: '-creation_date'}">
            <template slot="title"><translate>Recently listened</translate></template>
          </track-widget>
        </div>
        <div class="column">
          <track-widget :url="'favorites/tracks/'" :filters="{scope: 'user', ordering: '-creation_date'}">
            <template slot="title"><translate>Recently favorited</translate></template>
          </track-widget>
        </div>
        <div class="column">
          <h3 class="ui header">
            <translate>Radios</translate>
          </h3>
          <radio-card :type="'favorites'"></radio-card>
          <radio-card :type="'random'"></radio-card>
          <radio-card :type="'less-listened'"></radio-card>
        </div>
        <!-- <div class="column">
          <h2 class="ui header">
            <translate>Music requests</translate>
          </h2>
          <request-form v-if="$store.state.auth.authenticated"></request-form>
        </div> -->
      </div>
      <div class="ui section hidden divider"></div>
      <div class="ui grid">
        <div class="ui row">
          <album-widget :filters="{ordering: '-creation_date'}">
            <template slot="title"><translate>Recently added</translate></template>
          </album-widget>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios'
import Search from '@/components/audio/Search'
import logger from '@/logging'
import ArtistCard from '@/components/audio/artist/Card'
import RadioCard from '@/components/radios/Card'
import RequestForm from '@/components/requests/Form'
import TrackWidget from '@/components/audio/track/Widget'
import AlbumWidget from '@/components/audio/album/Widget'

const ARTISTS_URL = 'artists/'

export default {
  name: 'library',
  components: {
    Search,
    ArtistCard,
    RadioCard,
    TrackWidget,
    AlbumWidget,
    RequestForm
  },
  data () {
    return {
      artists: [],
      isLoadingArtists: false
    }
  },
  created () {
    this.fetchArtists()
  },
  computed: {
    labels () {
      return {
        title: this.$gettext('Home')
      }
    }
  },
  methods: {
    fetchArtists () {
      var self = this
      this.isLoadingArtists = true
      let params = {
        ordering: '-creation_date',
        listenable: true
      }
      let url = ARTISTS_URL
      logger.default.time('Loading latest artists')
      axios.get(url, {params: params}).then((response) => {
        self.artists = response.data.results
        logger.default.timeEnd('Loading latest artists')
        self.isLoadingArtists = false
      })
    }
  }
}
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
</style>
